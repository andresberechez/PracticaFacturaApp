@model FacturaApp.Dominio.Factura
@{
    ViewData["Title"] = "PlantillaFactura";
    //FacturaApp.Dominio.Producto productoSeleccionadoModel;
}

<h1>PlantillaFactura</h1>



<!DOCTYPE html>

<html>
<head>
    <meta name="viewport" content="width=device-width" />
    <title>Index</title>
    <link rel="stylesheet" href="~/lib/bootstrap/dist/css/bootstrap.min.css" />
</head>
<body>




<nav aria-label="breadcrumb">
    <ol class="breadcrumb">
        <li class="breadcrumb-item"><a href="#">Ventas</a></li>
    </ol>
</nav>

<div class="row">
    <div class="col-sm-12">
        <div class="card border-info">
            <div class="card-header p-2 bg-info text-white">
                Detalle Venta
                <button id="btnTerminarGuardarVenta" class="btn btn-warning btn-sm float-right">
                    <i class="fa fa-print" aria-hidden="true"></i> Imprimir y Terminar Venta
                </button>
            </div>
            <div class="card-body p-2 card-venta">
                <div class="row">
                    <div class="col-sm-3">
                        <div class="input-group input-group-sm mb-2">
                            <div class="input-group-prepend">
                                <label class="input-group-text bg-info text-white" for="inputGroupSelect01">Tipo Documento</label>
                            </div>
                            <input id="txtfechaventa" readonly type="text" class="form-control" value="Factura">

                            @*<select class="custom-select" id="cboventatipodocumento">
                            <option value="Boleta">Boleta</option>
                            <option value="Factura">Factura</option>
                            </select>*@

                        </div>
                    </div>
                    <div class="col-sm-3">
                        <div class="input-group input-group-sm mb-2">
                            <div class="input-group-prepend">
                                <label class="input-group-text bg-info text-white" for="inputGroupSelect01">Fecha de Venta</label>
                            </div>
                            <input id="txtfechaventa" type="date" class="form-control" asp-for="Fecha" max="@DateTime.Today.ToString("yyyy-MM-dd")">
                            @*<input id="txtfechaventa" readonly type="text" class="form-control">*@
                        </div>
                    </div>
                </div>
                <div class="row">
                    <div class="col-sm-6">
                        <div class="card bg-info text-white border-info">
                            <div class="card-body p-2">
                                <div class="row">
                                    <div class="col-sm-10">
                                        <h6 class="card-title mb-1">Tienda origen</h6>
                                    </div>
                                    <div class="col-sm-2">
                                        <div class="float-right">
                                            <a class="btn btn-light btn-sm" data-toggle="collapse" href="#collapse1" role="button" aria-expanded="false" aria-controls="collapseExample">
                                                <i class="fa fa-bars" aria-hidden="true"></i>
                                            </a>
                                        </div>
                                    </div>

                                </div>

                                <div class="row collapse" id="collapse1">
                                    <input id="txtIdTienda" type="hidden" value="0" />
                                    <div class="col-sm-4">
                                        <div class="form-group mb-0">
                                            <label for="txtRazonSocialProveedor" class="col-form-label col-form-label-sm">Nombre:</label>
                                            <label class="form-control form-control-sm model mb-1" readonly id="lbltiendanombre"></label>
                                        </div>
                                    </div>
                                    <div class="col-sm-4">
                                        <div class="form-group mb-0">
                                            <label for="txtRazonSocialProveedor" class="col-form-label col-form-label-sm">RUC:</label>
                                            <label class="form-control form-control-sm model mb-1" readonly id="lbltiendaruc"></label>
                                        </div>
                                    </div>
                                    <div class="col-sm-4">
                                        <div class="form-group mb-0">
                                            <label for="txtRazonSocialProveedor" class="col-form-label col-form-label-sm">Direccion:</label>
                                            <label class="form-control form-control-sm model mb-1" readonly id="lbltiendadireccion"></label>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="col-sm-6">
                        <div class="card bg-info text-white border-info">
                            <div class="card-body p-2">

                                <div class="row">
                                    <div class="col-sm-10">
                                        <h6 class="card-title mb-1">Datos Empleado</h6>
                                    </div>
                                    <div class="col-sm-2">
                                        <div class="float-right">
                                            <a class="btn btn-light btn-sm" data-toggle="collapse" href="#collapse2" role="button" aria-expanded="false" aria-controls="collapseExample">
                                                <i class="fa fa-bars" aria-hidden="true"></i>
                                            </a>
                                        </div>
                                    </div>

                                </div>

                                <div class="row collapse" id="collapse2">
                                    <input id="txtIdUsuario" type="hidden" value="0" />
                                    <div class="col-sm-4">
                                        <div class="form-group mb-0">
                                            <label for="txtRucProveedor" class="col-form-label col-form-label-sm">Nombre:</label>
                                            <label class="form-control form-control-sm model mb-1" readonly id="lblempleadonombre"></label>
                                        </div>
                                    </div>
                                    <div class="col-sm-4">
                                        <div class="form-group mb-0">
                                            <label for="txtRazonSocialProveedor" class="col-form-label col-form-label-sm">Apellido:</label>
                                            <label class="form-control form-control-sm model mb-1" readonly id="lblempleadoapellido"></label>
                                        </div>
                                    </div>
                                    <div class="col-sm-4">
                                        <div class="form-group mb-0">
                                            <label for="txtRazonSocialProveedor" class="col-form-label col-form-label-sm">Correo:</label>
                                            <label class="form-control form-control-sm model mb-1" readonly id="lblempleadocorreo"></label>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="row mt-2">

                    @*Detalle cliente*@
                    <div class="col-sm-6">
                        <div class="card border-info">

                            <div class="card-body p-2">
                                <h6 class="card-title mb-1 text-info">Detalle cliente</h6>

                                <div class="row align-items-end">

                                    <div class="col-sm-6">
                                        <div class="form-group mb-0">

                                            <label for="txtRazonSocialProveedor" class="col-form-label col-form-label-sm">Cedula: <span class="required">*</span> </label>
                                            <input type="text" class="form-control form-control-sm model" id="txtclientedocumento" name="RazonSocial" autocomplete="off">
                                        </div>
                                    </div>

                                    <div class="col-sm-6">
                                        <div class="form-group mb-0">
                                            <label for="txtRazonSocialProveedor" class="col-form-label col-form-label-sm">Nombre: <span class="required">*</span></label>
                                            <input type="text" class="form-control form-control-sm model" id="txtclientenombres" name="RazonSocial" autocomplete="off">
                                        </div>
                                    </div>

                                </div>

                                <div class="row">
                                    <div class="col-sm-4">
                                        <div class="form-group mb-0">
                                            <label for="txtRazonSocialProveedor" class="col-form-label col-form-label-sm">Direccion:</label>
                                            <input type="text" class="form-control form-control-sm model" id="txtclientedireccion" name="clientedireccion" autocomplete="off">
                                        </div>
                                    </div>

                                    <div class="col-sm-4">
                                        <div class="form-group mb-0">
                                            <label for="txtRazonSocialProveedor" class="col-form-label col-form-label-sm">Telefono:</label>
                                            <input type="text" class="form-control form-control-sm model" id="txtclientetelefono" name="RazonSocial" autocomplete="off">
                                        </div>
                                    </div>

                                    <div class="col-sm-4">
                                        <div class="form-group mb-0">
                                            <label for="" class="col-form-label col-form-label-sm">Correo:</label>
                                            <input type="text" class="form-control form-control-sm model" id="" name="RazonSocial" autocomplete="off">
                                        </div>
                                    </div>

                                </div>

                                <div class="row">
                                    <div class="ol-sm-2 mt-4">
                                        <div class="form-group mb-0">
                                            <button id="btnBuscarCliente" type="button" class="btn btn-sm btn-primary btn-block"><i class="fas fa-search"></i> Buscar</button>
                                        </div>
                                    </div>
                                </div>

                            </div>
                        </div>
                    </div>


                    @*Detalle Producto*@
                    <div class="col-sm-6">
                        <div class="card border-info">

                            <div class="card-body p-2">
                                <h6 class="card-title mb-1 text-info">Detalle Producto</h6>

                                <div class="row align-items-end">

                                    <input id="txtIdProducto" type="hidden" value="0" />

                                    <form id="formulario">

                                        <div class="col-sm-4">
                                            <div class="form-group mb-0">


                                                <select class="form-control producto-select" id="Codigo">
                                                    @foreach (var producto in ViewBag.Productos)
                                                    {
                                                        @*<option value="@producto.Codigo">@producto.Descripcion</option>*@
                                                        <option value='{"producto":{"Codigo":"@producto.Codigo","Descripcion":"@producto.Descripcion", "Categoria": "@producto.Categoria"}}'>@producto.Descripcion</option>

                                                        @*{"producto":{"Codigo":"@producto.Codigo","Descripcion":"@producto.Descripcion"}}'*@

                                                    }
                                                </select>

                                            </div>
                                        </div>

                                        <div class="col-sm-4">
                                            <div class="form-group mb-0">
                                                <label for="Descripcion" class="col-form-label col-form-label-sm">Descripcion:</label>
                                                <input type="text" class="form-control form-control-sm model" readonly id="Descripcion" name="Descripcion">
                                            </div>
                                        </div>

                                        <div class="col-sm-4">
                                            <div class="form-group mb-0">
                                                <label for="Categoria" class="col-form-label col-form-label-sm">Categoria:</label>
                                                <input type="text" class="form-control form-control-sm model" readonly id="Categoria" name="Categoria">
                                            </div>
                                        </div>



                                        <div class="col-sm-2 mt-4">
                                            <div class="form-group mb-0">
                                                @*<label for="btnAsignar" class="col-form-label col-form-label-sm invisible">Buscar:</label>*@
                                                <button id="btnAgregar" type="submit" class="btn btn-sm btn-success btn-block">Agregar</button>
                                            </div>
                                        </div>


                                    </form>



                                </div>

                                @*<div id="lista-resultados"></div>*@



                            </div>

                        </div>

                    </div>

                </div>

            </div> @*Fin de 2 cards juntos*@


            <hr />

            <div class="row">
                <div class="col-sm-12"><h6 class="text-info">Detalle Productos</h6></div>
            </div>

            <div class="row mt-3">
                <div class="col-sm-12">
                    <div class="table-responsive-sm">
                        <table id="tbVenta" class="table table-striped table-bordered nowrap table-sm" style="width:100%">
                            <thead>
                                <tr>
                                    <th></th>
                                    <th>Cantidad</th>
                                    <th>Producto</th>
                                    <th>Descripcion</th>
                                    <th>Precio Unidad</th>
                                    <th>IVA</th>
                                    <th>Subtotal</th>
                                </tr>
                            </thead>

                            <tbody id="tbody-detalle">
                            </tbody>

                        </table>
                    </div>
                </div>
            </div>

            <hr />

            <div class="row">

                <div class="col-sm-6">
                    <div class="row">

                        <div class="col-sm-4">
                            <div class="input-group input-group-sm mb-2">
                                <div class="input-group-prepend">
                                    <label class="input-group-text bg-info text-white" for="inputGroupSelect01">Sub Total</label>
                                </div>
                                <input id="txtsubtotal" readonly type="text" class="form-control" value="0">
                            </div>
                        </div>

                        <div class="col-sm-4">
                            <div class="input-group input-group-sm mb-2">
                                <div class="input-group-prepend">
                                    <label class="input-group-text bg-info text-white" for="inputGroupSelect01">IVA Total</label>
                                </div>
                                <input id="txtigv" readonly type="text" class="form-control" value="0">
                            </div>
                        </div>

                        <div class="col-sm-4">
                            <div class="input-group input-group-sm mb-2">
                                <div class="input-group-prepend">
                                    <label class="input-group-text bg-info text-white" for="inputGroupSelect01">Total</label>
                                </div>
                                <input id="txttotal" readonly type="text" class="form-control" value="0">
                            </div>
                        </div>

                    </div>
                </div>


                <div class="col-sm-6">
                    <div class="row">

                        <div class="col-sm-4">
                            <div class="input-group input-group-sm mb-2">
                                <div class="input-group-prepend">
                                    <label class="input-group-text bg-info text-white" for="inputGroupSelect01">Monto Pago</label>
                                </div>
                                <input id="txtmontopago" type="text" class="form-control" autocomplete="off">
                            </div>
                        </div>

                        <div class="col-sm-4">
                            <button id="btncalcular" type="button" class="btn btn-sm btn-success btn-block"><i class="fas fa-dollar-sign"></i>  Calcular</button>
                        </div>

                        <div class="col-sm-4">
                            <div class="input-group input-group-sm mb-2">
                                <div class="input-group-prepend">
                                    <label class="input-group-text bg-info text-white" for="inputGroupSelect01">Cambio</label>
                                </div>
                                <input id="txtcambio" readonly type="text" class="form-control">
                            </div>
                        </div>

                    </div>
                </div>

            </div>
        </div>

    </div>
</div>
    </div>

<!-- MODAL PRODUCTOS -->
<div class="modal fade" id="modalProducto" tabindex="-1" role="dialog" data-backdrop="static" aria-labelledby="exampleModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-lg" role="document">
        <div class="modal-content">

            <div class="modal-header bg-info text-white">
                <h5 class="modal-title">Productos</h5>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>

            <div class="modal-body">
                <div class="table-responsive">
                    <table id="tbProducto" class="table table-striped table-bordered nowrap compact" style="width:100%">
                        <thead>
                            <tr>
                                <th></th>
                                <th>Codigo</th>
                                <th>Descripcion</th>
                                <th>Categoria</th>
                            </tr>
                        </thead>
                        <tbody></tbody>
                    </table>
                </div>

            </div>
        </div>
    </div>
</div>

<!-- MODAL CLIENTES -->
<div class="modal fade" id="modalCliente" tabindex="-1" role="dialog" data-backdrop="static" aria-labelledby="exampleModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-lg" role="document">
        <div class="modal-content">

            <div class="modal-header bg-info text-white">
                <h5 class="modal-title">ClientesSSSSSSSSSS</h5>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>

            <div class="modal-body">
                <div class="table-responsive">
                    <table id="tbcliente" class="table table-striped table-bordered nowrap compact" style="width:100%">
                        <thead>
                            <tr>
                                <th></th>
                                <th>Identificaciono</th>
                                <th>Nombre</th>
                                <th>Direccion</th>
                                <th>Telefono</th>
                                <th>Correo</th>
                            </tr>
                        </thead>
                        <tbody></tbody>
                    </table>
                </div>

            </div>
        </div>
    </div>
</div>



<script src="~/lib/bootstrap/dist/js/bootstrap.bundle.min.js"></script>


    //<script>

          //    const formulario = document.querySelector('#formulario');

          //    const listaResultados = document.querySelector('#lista-resultados');


          //    formulario.addEventListener('submit', (event) => {
          //        event.preventDefault();

          //        const Codigo = document.querySelector('#Codigo').value;
          //        const Descripcion = document.querySelector('#Descripcion').value;
          //        const Categoria = document.querySelector('#Categoria').value;

          //        const listaDatos = [
          //            {
          //                "Codigo": Codigo,
          //                "Descripcion": Descripcion,
          //                "Categoria": Categoria
          //            }
          //        ];

          //        const htmlLista = listaDatos.map(item => `
          //                    <div class="row">

          //            <div class="col-sm-4">
          //                <div class="form-group mb-0">
          //                    <input type="text" class="form-control form-control-sm model" readonly id="Descripcion" name="Codigo" value="${item.Codigo}">
          //                </div>
          //            </div>

          //            <div class="col-sm-4">
          //                <div class="form-group mb-0">
          //                    <input type="text" class="form-control form-control-sm model" readonly id="Descripcion" name="Descripcion" value="${item.Descripcion}">
          //                </div>
          //            </div>

          //            <div class="col-sm-4">
          //                <div class="form-group mb-0">
          //                    <input type="text" class="form-control form-control-sm model" readonly id="Categoria" name="Categoria" value="${item.Categoria}">
          //                </div>
          //            </div>

          //        </div>
          //          `).join('');


          //        const htmlListaDetallesProductos = listaDatos.map(item => `
          //        <tr>
          //            <td></td>
          //            <td>${item.Codigo}</td>
          //            <td>${item.Descripcion}</td>
          //            <td> ${item.Categoria}</td>
          //            <td> 3 </td>
          //            <td> 0.45 </td>
          //            <td> 3.45 </td>
          //        </tr>
          //            `).join('');


          //        listaDatos.map(item => console.log(item));
          //        listaDatos.map(item => console.log(item.Codigo));
          //        listaDatos.map(item => console.log(item.Descripcion));
          //        listaDatos.map(item => console.log(item.Categoria));


          //        listaResultados.innerHTML = htmlLista;


          //    });

          // </script>




<script>

    const formulario = document.querySelector('#formulario');

    //const listaResultados = document.querySelector('#lista-resultados');
    const tablaDetallesProductos = document.querySelector('#tbody-detalle');

    const productoSeleccionado = JSON.parse(document.querySelector('#Codigo').value);
    const codigoProducto = productoSeleccionado.producto.Codigo;
    const descripcionProducto = productoSeleccionado.producto.Descripcion;
    const CategoriaProducto = productoSeleccionado.producto.Categoria;


    formulario.addEventListener('submit', (event) => {
        event.preventDefault();

        const listaDatos = [
            {
                "Codigo": codigoProducto,
                "Descripcion": descripcionProducto,
                "Categoria": CategoriaProducto
            }
        ];


        const htmlLista = listaDatos.map(item => `
                <div class="row">

                    <div class="col-sm-4">
                        <div class="form-group mb-0">
                            <input type="text" class="form-control form-control-sm model" readonly id="Descripcion" name="Codigo" value="${item.Codigo}">
                        </div>
                    </div>

                    <div class="col-sm-4">
                        <div class="form-group mb-0">
                            <input type="text" class="form-control form-control-sm model" readonly id="Descripcion" name="Descripcion" value="${item.Descripcion}">
                        </div>
                    </div>

                    <div class="col-sm-4">
                        <div class="form-group mb-0">
                            <input type="text" class="form-control form-control-sm model" readonly id="Categoria" name="Categoria" value="${item.Categoria}">
                        </div>
                    </div>

                </div>
                `).join('');


        const htmlListaDetallesProductos = listaDatos.map(item => `
                <tr>
                    <td></td>
                    <td>${item.Codigo}</td>
                    <td>${item.Descripcion}</td>
                    <td> ${item.Categoria}</td>
                    <td> 3 </td>
                    <td> 0.45 </td>
                    <td> 3.45 </td>
                </tr>
                `).join('');


        listaDatos.map(item => console.log(item));
        listaDatos.map(item => console.log(item.Codigo));
        listaDatos.map(item => console.log(item.Descripcion));
        listaDatos.map(item => console.log(item.Categoria));


        //listaResultados.innerHTML = htmlLista;
        tablaDetallesProductos.innerHTML = htmlListaDetallesProductos;

    });


</script>



@*==================================================================*@
@*==================================================================*@
@*==================================================================*@
@*==================================================================*@
@*==================================================================*@



<script src="~/lib/bootstrap/dist/js/bootstrap.bundle.min.js"></script>
<script src="~/js/ListarProducto.js"></script>



</body>
</html>